<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="/Users/Nithin/Documents/NEU/ITC 6000/Main Project/Nithin_Reddy_PMS_MainProject..db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="5213"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,9:mainemployees"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="attendance" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="82"/><column index="2" value="46"/><column index="3" value="87"/><column index="4" value="83"/><column index="5" value="55"/><column index="6" value="52"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="bank" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="50"/><column index="2" value="68"/><column index="3" value="58"/><column index="4" value="96"/><column index="5" value="92"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="company_data" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="8" mode="0"/></sort><column_widths><column index="1" value="129"/><column index="2" value="46"/><column index="3" value="65"/><column index="4" value="63"/><column index="5" value="85"/><column index="6" value="44"/><column index="7" value="50"/><column index="8" value="66"/><column index="9" value="159"/><column index="10" value="274"/><column index="11" value="116"/><column index="12" value="35"/><column index="13" value="45"/><column index="14" value="71"/><column index="15" value="26"/><column index="16" value="83"/><column index="17" value="103"/><column index="18" value="74"/><column index="19" value="114"/><column index="20" value="294"/><column index="21" value="103"/><column index="22" value="71"/><column index="23" value="60"/><column index="24" value="83"/><column index="25" value="99"/><column index="26" value="73"/><column index="27" value="67"/><column index="28" value="86"/><column index="29" value="84"/><column index="30" value="52"/><column index="31" value="70"/><column index="32" value="66"/><column index="33" value="82"/><column index="34" value="87"/><column index="35" value="52"/><column index="36" value="55"/><column index="37" value="83"/><column index="38" value="49"/><column index="39" value="67"/><column index="40" value="61"/><column index="41" value="63"/><column index="42" value="92"/><column index="43" value="76"/><column index="44" value="129"/><column index="45" value="50"/><column index="46" value="68"/><column index="47" value="58"/><column index="48" value="96"/><column index="49" value="92"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="departments" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="44"/><column index="2" value="69"/><column index="3" value="67"/><column index="4" value="71"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="employees" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="46"/><column index="2" value="44"/><column index="3" value="66"/><column index="4" value="36"/><column index="5" value="28"/><column index="6" value="26"/><column index="7" value="35"/><column index="8" value="40"/><column index="9" value="50"/><column index="10" value="92"/><column index="11" value="49"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="payroll" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="60"/><column index="2" value="83"/><column index="3" value="73"/><column index="4" value="40"/><column index="5" value="66"/><column index="6" value="63"/><column index="7" value="70"/><column index="8" value="99"/><column index="9" value="46"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="positions" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="66"/><column index="2" value="159"/><column index="3" value="274"/><column index="4" value="116"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="tax" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="92"/><column index="2" value="76"/><column index="3" value="52"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="users" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="49"/><column index="2" value="67"/><column index="3" value="59"/><column index="4" value="63"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">CREATE TABLE employees(
    emp_id INTEGER,
    dep_id INTEGER,
    position_id INTEGER,
    employee_name TEXT,
    dob TEXT,
    sex TEXT,
    state TEXT,
    salary REAL,
    bank_id INTEGER,
    tax_category_id INTEGER,
    user_id INTEGER
);


CREATE TABLE attendance (
    attendance_id INTEGER PRIMARY KEY,
    emp_id INTEGER,
    month TEXT,
    hours_worked REAL,
    overtime REAL,
    absence INTEGER
);

CREATE TABLE departments (
    dep_id INTEGER PRIMARY KEY,
    department TEXT,
    description TEXT,
    manager_id INTEGER
);

CREATE TABLE positions (
    position_id INTEGER PRIMARY KEY,
    position TEXT,
    job_des TEXT,
    sal_range TEXT
);

CREATE TABLE bank (
    bank_id INTEGER PRIMARY KEY,
    bank_name TEXT,
    branch TEXT,
    account_number TEXT,
    routing_number TEXT
);

CREATE TABLE tax (
    tax_category_id INTEGER PRIMARY KEY,
    tax_category TEXT,
    tax_rate REAL
);

CREATE TABLE users (
    user_id INTEGER PRIMARY KEY,
    user_name TEXT,
    password TEXT,
    user_type TEXT
);

CREATE TABLE payroll (
    payroll_id INTEGER PRIMARY KEY,
    payroll_period TEXT,
    payroll_date TEXT,
    salary REAL,
    deductions REAL,
    net_salary REAL,
    tax_witheld REAL,
    payment_method TEXT,
    emp_id INTEGER
);

INSERT INTO attendance (emp_id, month, hours_worked, overtime, absence)
SELECT 
    cd.emp_id AS empl_id,
    cd.month AS month,
    cd.hours_worked AS hours_worked,
    cd.overtime AS overtime,
    cd.absence AS absence
FROM 
    company_data AS cd

INSERT INTO payroll (payroll_period, payroll_date, salary, deductions, net_salary, tax_witheld, payment_method, emp_id)
SELECT DISTINCT
    cd.payroll_period AS payroll_period,
    cd.payroll_date AS payroll_date,
    cd.salary AS salary,
    cd.deductions AS deductions,
    cd.net_salary AS net_salary,
    cd.tax_witheld AS tax_witheld,
    cd.payment_method AS payment_method,
    cd.emp_id AS emp_id
FROM company_data AS cd;

INSERT INTO departments (department, description, manager_id)
SELECT 
    cd.department AS department,
    cd.description AS description,
    cd.manager_id AS manager_id
FROM 
    company_data AS cd;
	
INSERT INTO positions (position, job_des, sal_range)
SELECT 
    cd.position AS position,
    cd.job_des AS job_des,
    cd.sal_range AS sal_range
FROM 
    company_data AS cd;


INSERT INTO bank (bank_id, bank_name, branch, account_number, routing_number)
SELECT 
    cd.bank_id AS bank_id,
    cd.bank_name AS bank_name,
    cd.branch AS branch,
    cd.account_number AS account_number,
    cd.routing_number AS routing_number
FROM 
    company_data AS cd;

INSERT INTO tax (tax_category_id, tax_category, tax_rate)
SELECT 
    cd.tax_category_id AS tax_category_id,
    cd.tax_category AS tax_category,
    cd.tax_rate AS tax_rate
FROM 
    company_data AS cd;

INSERT INTO employees (emp_id, dep_id, position_id, employee_name, dob, sex, state, salary, bank_id, tax_category_id, user_id)
SELECT 
    cd.emp_id AS emp_id,
    cd.dep_id AS dep_id,
    cd.position_id AS position_id,
    cd.employee_name AS employee_name,
    cd.dob AS dob,
    cd.sex AS sex,
    cd.state AS state,
    cd.salary AS salary,
    cd.bank_id AS bank_id,
    cd.tax_category_id AS tax_category_id,
    cd.user_id AS user_id
FROM 
    company_data AS cd;

INSERT INTO users (user_id, user_name, password, user_type)
SELECT 
    cd.user_id AS user_id,
    cd.user_name AS user_name,
    cd.password AS password,
    cd.user_type AS user_type
FROM 
    company_data AS cd;

SELECT 
    e.emp_id AS emp_id,
    d.department AS department,
    p.position AS position
FROM 
    employees AS e
INNER JOIN 
    departments AS d ON e.dep_id = d.dep_id
INNER JOIN 
    positions AS p ON e.position_id = p.position_id;

SELECT 
    e.emp_id AS emp_id,
    d.department AS department,
    p.position AS position,
    pr.payroll_id AS payroll_id,
    pr.payroll_period AS payroll_period,
    pr.salary AS salary
FROM 
    employees AS e
JOIN 
    departments AS d ON e.dep_id = d.dep_id
JOIN 
    positions AS p ON e.position_id = p.position_id
JOIN 
    payroll AS pr ON e.emp_id = pr.emp_id;
	
SELECT 
    e.emp_id AS emp_id,
    d.department AS department,
    b.bank_name AS bank_name,
    b.account_number AS account_number,
    t.tax_category AS tax_category
FROM 
    employees AS e
JOIN 
    departments AS d ON e.dep_id = d.dep_id
JOIN 
    bank AS b ON e.bank_id = b.bank_id
JOIN 
    tax AS t ON e.tax_category_id = t.tax_category_id;

SELECT 
    e.emp_id AS emp_id,
    p.position AS position,
    pr.payroll_period AS payroll_period,
    u.user_type AS user_account_type
FROM 
    employees AS e
JOIN 
    positions AS p ON e.position_id = p.position_id
JOIN 
    payroll AS pr ON e.emp_id = pr.emp_id
JOIN 
    users AS u ON e.user_id = u.user_id;

SELECT 
    e.emp_id AS emp_id,
    d.department AS department,
    a.month AS month,
    b.branch AS bank_branch
FROM 
    employees AS e
JOIN 
    departments AS d ON e.dep_id = d.dep_id
LEFT JOIN 
    attendance AS a ON e.emp_id = a.emp_id
LEFT JOIN 
    bank AS b ON e.bank_id = b.bank_id;

SELECT strftime('%Y', payroll_period) AS Year, strftime('%m', payroll_period) AS Month, SUM(salary) AS Total_Salary
FROM payroll
GROUP BY strftime('%Y', payroll_period), strftime('%m', payroll_period)
ORDER BY Year, Month;

SELECT e.emp_id, a.month, a.hours_worked, a.overtime, a.absence
FROM employees e
INNER JOIN attendance a ON e.emp_id = a.emp_id
WHERE a.month LIKE '%October%';

SELECT t.tax_category, SUM(p.tax_witheld) AS TotalTaxWithheld
FROM payroll p
JOIN employees e ON p.emp_id = e.emp_id
JOIN tax t ON e.tax_category_id = t.tax_category_id
GROUP BY t.tax_category;


SELECT d.department, SUM(p.net_salary) AS TotalSalary
FROM employees e
INNER JOIN departments d ON e.dep_id = d.dep_id
INNER JOIN payroll p ON e.emp_id = p.emp_id
GROUP BY d.department;
</sql><current_tab id="0"/></tab_sql></sqlb_project>
